
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Fuzzy C-Mean Clustering &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'fuzzycmeansnb';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Selamat datang Di catatan Penambangan Data
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="datamining.html">Data Understanding</a></li>
<li class="toctree-l1"><a class="reference internal" href="UTSPendataE.html"><strong>Mengistall Pandas terlebih dahulu</strong></a></li>



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Ffuzzycmeansnb.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/fuzzycmeansnb.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Fuzzy C-Mean Clustering</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#konsep-dasar-fuzzy-c-mean-clustering"><strong>Konsep dasar Fuzzy C-Mean Clustering</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algoritma-fuzzy-c-mean-clustering"><strong>Algoritma Fuzzy C-Mean Clustering</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-langkah-fuzzy-c-mean-clustering"><strong>Langkah-langkah Fuzzy C-Mean Clustering</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-derajat-keanggotaaan"><strong>Update derajat keanggotaaan</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-pusat-cluster"><strong>Update pusat Cluster</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contoh-manual-perhitungan-fuzzy-c-mean-2claster"><strong>Contoh Manual Perhitungan Fuzzy C-Mean (2claster)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#contoh-data-x-1-2">Contoh data <span class="math notranslate nohighlight">\(x_1 = 2\)</span>:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-python-serta-menampilkan-nilai-pusat-cluster-keanggotaan-setiap-iterasi-dan-hitung-fungsi-objektif-setiap-iterasi"><strong>Implementasi Python serta Menampilkan nilai pusat cluster,keanggotaan setiap iterasi dan hitung fungsi objektif setiap iterasi</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-fuzzy-c-means-clustering-untuk-data-iris-3cluster"><strong>Implementasi Fuzzy C-Means Clustering Untuk data Iris (3Cluster)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inisialisasi-data-iris-dan-parameter"><strong>inisialisasi Data Iris dan Parameter</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inisialisasi-derajat-keanggotaan"><strong>Inisialisasi derajat Keanggotaan</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hitung-centroid-berdasarkan-matriks-keanggotaan-u"><strong>Hitung centroid berdasarkan matriks keanggotaan U</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-matriks-keanggotaan-u"><strong>Update matriks keanggotaan U</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hitung-fungsi-objektif-dan-cek-konvergensi"><strong>Hitung Fungsi Objektif dan Cek Konvergensi</strong></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="fuzzy-c-mean-clustering">
<h1><strong>Fuzzy C-Mean Clustering</strong><a class="headerlink" href="#fuzzy-c-mean-clustering" title="Link to this heading">#</a></h1>
<section id="konsep-dasar-fuzzy-c-mean-clustering">
<h2><strong>Konsep dasar Fuzzy C-Mean Clustering</strong><a class="headerlink" href="#konsep-dasar-fuzzy-c-mean-clustering" title="Link to this heading">#</a></h2>
<p>Fuzzy C-Means (FCM) adalah salah satu metode clustering yang memungkinkan satu data menjadi anggota lebih dari satu cluster dengan derajat keanggotaan tertentu (nilai antara 0 dan 1). Berbeda dengan k-means yang bersifat hard clustering (anggota hanya milik satu cluster), FCM bersifat <em>soft clustering</em>.</p>
<p>Berbeda dengan metode K-Means yang bersifat tegas, FCM memungkinkan fleksibilitas dalam menentukan klaster karena setiap data memiliki nilai keanggotaan terhadap semua klaster yang totalnya berjumlah 1.</p>
<p>Tujuan utama dari algoritma ini adalah meminimalkan fungsi objektif yang mempertimbangkan jarak data terhadap pusat klaster dan tingkat keanggotaannya. Algoritma ini bekerja secara iteratif dengan menghitung pusat klaster dan memperbarui nilai keanggotaan hingga nilai-nilai tersebut stabil atau konvergen.</p>
<p>Keunggulan FCM terletak pada kemampuannya menangani data yang tidak memiliki batas klaster yang jelas, sehingga cocok untuk aplikasi dunia nyata seperti segmentasi citra atau analisis perilaku konsumen. Namun, algoritma ini juga memiliki kelemahan, seperti sensitif terhadap inisialisasi awal dan lambat saat digunakan pada data dalam jumlah besar. Selain itu, parameter fuzziness (biasanya disimbolkan dengan
ùëö
m) memengaruhi tingkat ‚Äúkabur‚Äù-nya keanggotaan, dan harus ditentukan secara tepat agar hasil klasterisasi optimal.</p>
</section>
<section id="algoritma-fuzzy-c-mean-clustering">
<h2><strong>Algoritma Fuzzy C-Mean Clustering</strong><a class="headerlink" href="#algoritma-fuzzy-c-mean-clustering" title="Link to this heading">#</a></h2>
<p>Algoritma Fuzzy C-Means (FCM) adalah metode clustering yang menggunakan konsep fuzzy, di mana setiap data dapat menjadi anggota lebih dari satu cluster dengan derajat ketebalan yang berbeda, bernilai antara 0 sampai 1. Algoritma ini memungkinkan data memiliki keseluruhan parsial pada beberapa cluster, berbeda dengan metode clustering keras seperti K-Means yang hanya mengelompokkan data ke satu cluster saja.</p>
<section id="langkah-langkah-fuzzy-c-mean-clustering">
<h3><strong>Langkah-langkah Fuzzy C-Mean Clustering</strong><a class="headerlink" href="#langkah-langkah-fuzzy-c-mean-clustering" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Menentukan jumlah cluster (c) yang diinginkan.</p></li>
<li><p>Inisialisasi matriks derajat keanggotaan (U) secara acak, di mana setiap baris mewakili data dan setiap kolom mewakili cluster. Nilai derajat keanggotaan tiap data pada semua cluster harus berjumlah 1.</p></li>
<li><p>Menghitung pusat cluster (centroid) menggunakan rumus rata-rata berbobot, di mana bobotnya adalah derajat pengumpulan data yang dipangkatkan dengan parameter fuzziness M&gt;1.</p></li>
<li><p>Memperbarui derajat pengumpulan (U) berdasarkan jarak data ke pusat cluster yang baru dihitung, sehingga data yang lebih dekat ke pusat cluster memiliki derajat keanggotaan lebih tinggi.</p></li>
<li><p>Menghitung fungsi tujuan yang mengukur total jarak berbobot antara data dan pusat cluster. Fungsi ini diminimasi untuk mendapatkan hasil clustering terbaik.</p></li>
<li><p>Iterasi langkah 3 sampai 5 dilakukan sampai perubahan fungsi tujuan atau perubahan derajat pengumpulan lebih kecil dari nilai toleransi yang telah ditentukan, atau sampai mencapai jumlah iterasi maksimal.</p></li>
</ol>
<p><strong>Fungsi Objektif Fuzzy C-Means</strong></p>
<div class="math notranslate nohighlight">
\[
J_m = \sum_{i=1}^{n} \sum_{j=1}^{c} u_{ij}^m \cdot \|x_i - c_j\|^2
\]</div>
<p><strong>Keterangan:</strong></p>
<ul class="simple">
<li><p>( J_m ) : Fungsi objektif yang diminimalkan</p></li>
<li><p>( n ) : Jumlah data</p></li>
<li><p>( c ) : Jumlah klaster</p></li>
<li><p>( u_{ij} ) : Derajat keanggotaan data ke-(i) terhadap klaster ke-(j)</p></li>
<li><p>( m ) : Parameter fuzziness (biasanya ( m = 2 ))</p></li>
<li><p>( x_i ) : Data ke-(i)</p></li>
<li><p>( c_j ) : Pusat klaster ke-(j)</p></li>
<li><p>( |x_i - c_j| ) : Jarak antara data ke-(i) dan pusat klaster ke-(j) (biasanya Euclidean distance)</p></li>
</ul>
</section>
<section id="update-derajat-keanggotaaan">
<h3><strong>Update derajat keanggotaaan</strong><a class="headerlink" href="#update-derajat-keanggotaaan" title="Link to this heading">#</a></h3>
<p><strong>Rumus Update Derajat Keanggotaan (Membership Update)</strong></p>
<div class="math notranslate nohighlight">
\[
u_{ij} = \frac{1}{\sum_{k=1}^{c} \left( \frac{\|x_i - c_j\|}{\|x_i - c_k\|} \right)^{\frac{2}{m - 1}}}
\]</div>
<p><strong>Keterangan:</strong></p>
<ul class="simple">
<li><p>( u_{ij} ) : Derajat keanggotaan data ke-(i) terhadap klaster ke-(j)</p></li>
<li><p>( c ) : Jumlah klaster</p></li>
<li><p>( x_i ) : Data ke-(i)</p></li>
<li><p>( c_j ) : Pusat klaster ke-(j)</p></li>
<li><p>( |x_i - c_j| ) : Jarak antara data ke-(i) dan pusat klaster ke-(j)</p></li>
<li><p>( m ) : Parameter fuzziness (biasanya ( m = 2 ))</p></li>
</ul>
</section>
<section id="update-pusat-cluster">
<h3><strong>Update pusat Cluster</strong><a class="headerlink" href="#update-pusat-cluster" title="Link to this heading">#</a></h3>
<p><strong>Rumus Update Pusat Klaster</strong></p>
<div class="math notranslate nohighlight">
\[
c_j = \frac{\sum_{i=1}^{n} u_{ij}^m \cdot x_i}{\sum_{i=1}^{n} u_{ij}^m}
\]</div>
<p><strong>Keterangan:</strong></p>
<ul class="simple">
<li><p>( c_j ) : Pusat klaster ke-(j)</p></li>
<li><p>( n ) : Jumlah data</p></li>
<li><p>( u_{ij} ) : Derajat keanggotaan data ke-(i) terhadap klaster ke-(j)</p></li>
<li><p>( m ) : Parameter fuzziness (biasanya ( m = 2 ))</p></li>
<li><p>( x_i ) : Data ke-(i)</p></li>
</ul>
</section>
</section>
<section id="contoh-manual-perhitungan-fuzzy-c-mean-2claster">
<h2><strong>Contoh Manual Perhitungan Fuzzy C-Mean (2claster)</strong><a class="headerlink" href="#contoh-manual-perhitungan-fuzzy-c-mean-2claster" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Data dan Parameter</strong></p></li>
</ol>
<p><strong>Data Fitur:</strong>
$<span class="math notranslate nohighlight">\(
  X = \{2, 4, 5, 8\}
  \)</span>$</p>
<p><strong>Parameter:</strong></p>
<ul class="simple">
<li><p>Jumlah data = 4</p></li>
<li><p>Jumlah Cluster <em>C</em> = 2</p></li>
<li><p>Fuzziness ùëö = 2</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Inisialisasi Matriks keanggotaan <em>U</em> (Acak,tapi Jumlah data = 1)</strong></p></li>
</ol>
<p><strong>Derajat Keanggotaan</strong>=</p>
<div class="math notranslate nohighlight">
\[\begin{split}
U^{(X)} =
\begin{bmatrix}
Data &amp; 2 &amp; 4 &amp; 5 &amp; 8 \\
u1 &amp; 0.8 &amp; 0.6 &amp; 0.4 &amp; 0.3 \\
u2 &amp; 0.2 &amp; 0.4 &amp; 0.6 &amp; 0.7 \\
\end{bmatrix}
\end{split}\]</div>
<ol class="arabic simple" start="3">
<li><p><strong>Hitung centroid tiap cluster</strong></p></li>
</ol>
<p>Rumus centroid cluster <em>j</em>:</p>
<div class="math notranslate nohighlight">
\[
  v_j = \frac{\sum_{i=1}^{n} u_{ji}^m \cdot x_i}{\sum_{i=1}^{n} u_{ji}^m}
  \]</div>
<p>üìå<strong>Cluster 1:</strong></p>
<div class="math notranslate nohighlight">
\[
  v_1 = \frac{(0.8^2 \cdot 2) + (0.6^2 \cdot 4) + (0.4^2 \cdot 5) + (0.3^2 \cdot 8)}{0.8^2 + 0.6^2 + 0.4^2 + 0.3^2}
  = \frac{1.28 + 1.44 + 0.8 + 0.72}{0.64 + 0.36 + 0.16 + 0.09}
  = \frac{4.24}{1.25}
  \approx 3.392
  \]</div>
<p>üìå<strong>Cluster 2:</strong></p>
<div class="math notranslate nohighlight">
\[
  v_2 = \frac{(0.2^2 \cdot 2) + (0.4^2 \cdot 4) + (0.6^2 \cdot 5) + (0.7^2 \cdot 8)}{0.2^2 + 0.4^2 + 0.6^2 + 0.7^2}
  = \frac{0.08 + 0.64 + 1.8 + 3.92}{0.04 + 0.16 + 0.36 + 0.49}
  = \frac{6.44}{1.05}
  \approx 6.133
  \]</div>
<ol class="arabic simple" start="4">
<li><p><strong>Update Keanggotaan <em>U</em></strong></p></li>
</ol>
<p>Rumus Update Keanggotaan <span class="math notranslate nohighlight">\(u_{ji}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
  u_{ji} = \frac{1}{\sum_{k=1}^{c} \left(\frac{d(x_i, v_j)}{d(x_i, v_k)}\right)^{\frac{2}{m-1}}}
  \]</div>
<section id="contoh-data-x-1-2">
<h3>Contoh data <span class="math notranslate nohighlight">\(x_1 = 2\)</span>:<a class="headerlink" href="#contoh-data-x-1-2" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(d(x_1, v_1) = |2 - 3.392| = 1.392\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(d(x_1, v_2) = |2 - 6.133| = 4.133\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
  u_{1,1} = \frac{1}{\left(\frac{1.392}{1.392}\right)^2 + \left(\frac{1.392}{4.133}\right)^2}
  = \frac{1}{1 + (0.1134)^2}
  = \frac{1}{1 + 0.012}
  \approx 0.988
  \]</div>
<div class="math notranslate nohighlight">
\[
  u_{2,1} = 1 - u_{1,1} \approx 0.011
  \]</div>
<p>Ulangi cara tersebut untuk semua data dan cluster yang sudah dihitung.</p>
<ol class="arabic simple" start="5">
<li><p><strong>Cek Konvergensi</strong></p></li>
</ol>
<p>Bandingkan perubahan centroid <span class="math notranslate nohighlight">\(v_j\)</span> dengan iterasi sebelumnya. Jika perubahan semua centroid &lt; 0.01, maka <strong>konvergen</strong>.
Jika belum, Maka <strong>ulang ke Step 2</strong> dengan <span class="math notranslate nohighlight">\(U\)</span> yang baru.</p>
<p><strong>Fungsi Objektif <span class="math notranslate nohighlight">\(J_m\)</span></strong></p>
<p>Rumus:</p>
<div class="math notranslate nohighlight">
\[
  J_m = \sum_{j=1}^{c} \sum_{i=1}^{n} u_{ji}^m \cdot d^2(x_i, v_j)
  \]</div>
<p>Dengan <span class="math notranslate nohighlight">\(m = 2\)</span>, dan hasil sebelumnya (misalnya iterasi awal):</p>
<div class="math notranslate nohighlight">
\[
  J_m = (0.8^2 \cdot (2 - 3.392)^2) + (0.6^2 \cdot (4 - 3.392)^2) + \dots
  \]</div>
<p>Lanjutkan hingga menjumlahkan seluruh nilai dari 2 cluster dan 4 data.</p>
<hr class="docutils" />
<p><strong>Berikut ini detail tiap Iterasi</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-right"><p>Iterasi</p></th>
<th class="head text-right"><p>Centroid 1</p></th>
<th class="head text-right"><p>Centroid 2</p></th>
<th class="head text-right"><p>Fungsi Objektif $J_m$</p></th>
<th class="head text-right"><p>U[1,1]</p></th>
<th class="head text-right"><p>U[1,2]</p></th>
<th class="head text-right"><p>U[1,3]</p></th>
<th class="head text-right"><p>U[1,4]</p></th>
<th class="head text-right"><p>U[2,1]</p></th>
<th class="head text-right"><p>U[2,2]</p></th>
<th class="head text-right"><p>U[2,3]</p></th>
<th class="head text-right"><p>U[2,4]</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-right"><p>1</p></td>
<td class="text-right"><p>3.3920</p></td>
<td class="text-right"><p>6.1333</p></td>
<td class="text-right"><p>5.9336</p></td>
<td class="text-right"><p>0.8981</p></td>
<td class="text-right"><p>0.9249</p></td>
<td class="text-right"><p>0.3319</p></td>
<td class="text-right"><p>0.1410</p></td>
<td class="text-right"><p>0.1019</p></td>
<td class="text-right"><p>0.0751</p></td>
<td class="text-right"><p>0.6681</p></td>
<td class="text-right"><p>0.8590</p></td>
</tr>
<tr class="row-odd"><td class="text-right"><p>2</p></td>
<td class="text-right"><p>3.2056</p></td>
<td class="text-right"><p>6.8137</p></td>
<td class="text-right"><p>4.9054</p></td>
<td class="text-right"><p>0.9410</p></td>
<td class="text-right"><p>0.9262</p></td>
<td class="text-right"><p>0.5053</p></td>
<td class="text-right"><p>0.0577</p></td>
<td class="text-right"><p>0.0590</p></td>
<td class="text-right"><p>0.0738</p></td>
<td class="text-right"><p>0.4947</p></td>
<td class="text-right"><p>0.9423</p></td>
</tr>
<tr class="row-even"><td class="text-right"><p>3</p></td>
<td class="text-right"><p>3.2496</p></td>
<td class="text-right"><p>7.3196</p></td>
<td class="text-right"><p>4.4214</p></td>
<td class="text-right"><p>0.9477</p></td>
<td class="text-right"><p>0.9514</p></td>
<td class="text-right"><p>0.6372</p></td>
<td class="text-right"><p>0.0201</p></td>
<td class="text-right"><p>0.0523</p></td>
<td class="text-right"><p>0.0486</p></td>
<td class="text-right"><p>0.3628</p></td>
<td class="text-right"><p>0.9799</p></td>
</tr>
<tr class="row-odd"><td class="text-right"><p>4</p></td>
<td class="text-right"><p>3.3715</p></td>
<td class="text-right"><p>7.6164</p></td>
<td class="text-right"><p>4.2162</p></td>
<td class="text-right"><p>0.9437</p></td>
<td class="text-right"><p>0.9707</p></td>
<td class="text-right"><p>0.7208</p></td>
<td class="text-right"><p>0.0068</p></td>
<td class="text-right"><p>0.0563</p></td>
<td class="text-right"><p>0.0293</p></td>
<td class="text-right"><p>0.2792</p></td>
<td class="text-right"><p>0.9932</p></td>
</tr>
<tr class="row-even"><td class="text-right"><p>5</p></td>
<td class="text-right"><p>3.4637</p></td>
<td class="text-right"><p>7.7601</p></td>
<td class="text-right"><p>4.1537</p></td>
<td class="text-right"><p>0.9393</p></td>
<td class="text-right"><p>0.9801</p></td>
<td class="text-right"><p>0.7635</p></td>
<td class="text-right"><p>0.0028</p></td>
<td class="text-right"><p>0.0607</p></td>
<td class="text-right"><p>0.0199</p></td>
<td class="text-right"><p>0.2365</p></td>
<td class="text-right"><p>0.9972</p></td>
</tr>
<tr class="row-odd"><td class="text-right"><p>6</p></td>
<td class="text-right"><p>3.5128</p></td>
<td class="text-right"><p>7.8184</p></td>
<td class="text-right"><p>4.1402</p></td>
<td class="text-right"><p>0.9367</p></td>
<td class="text-right"><p>0.9840</p></td>
<td class="text-right"><p>0.7822</p></td>
<td class="text-right"><p>0.0016</p></td>
<td class="text-right"><p>0.0633</p></td>
<td class="text-right"><p>0.0160</p></td>
<td class="text-right"><p>0.2178</p></td>
<td class="text-right"><p>0.9984</p></td>
</tr>
<tr class="row-even"><td class="text-right"><p>7</p></td>
<td class="text-right"><p>3.5349</p></td>
<td class="text-right"><p>7.8403</p></td>
<td class="text-right"><p>4.1378</p></td>
<td class="text-right"><p>0.9354</p></td>
<td class="text-right"><p>0.9855</p></td>
<td class="text-right"><p>0.7899</p></td>
<td class="text-right"><p>0.0013</p></td>
<td class="text-right"><p>0.0646</p></td>
<td class="text-right"><p>0.0145</p></td>
<td class="text-right"><p>0.2101</p></td>
<td class="text-right"><p>0.9987</p></td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
<p>‚úÖ<strong>Hasil Konvergensi</strong></p>
<p>Konvergensi Tercapai pada iterasi ke-7</p>
</section>
</section>
<section id="implementasi-python-serta-menampilkan-nilai-pusat-cluster-keanggotaan-setiap-iterasi-dan-hitung-fungsi-objektif-setiap-iterasi">
<h2><strong>Implementasi Python serta Menampilkan nilai pusat cluster,keanggotaan setiap iterasi dan hitung fungsi objektif setiap iterasi</strong><a class="headerlink" href="#implementasi-python-serta-menampilkan-nilai-pusat-cluster-keanggotaan-setiap-iterasi-dan-hitung-fungsi-objektif-setiap-iterasi" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Langkah 1: Data dan parameter</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># derajat fuzziness</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># ambang konvergensi</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># batas maksimal iterasi (jika tidak konvergen)</span>

<span class="c1"># Langkah 2: Inisialisasi keanggotaan awal (manual)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Fungsi: Update centroid</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_centroids</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">um</span> <span class="o">=</span> <span class="n">U</span> <span class="o">**</span> <span class="n">m</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">um</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="o">/</span> <span class="n">um</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">centroids</span>  <span class="c1"># (2,)</span>

<span class="c1"># Fungsi: Update keanggotaan</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_membership</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">centroids</span><span class="p">)</span>
    <span class="n">new_U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
            <span class="n">denom</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
                <span class="n">d_ij</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="n">d_ik</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">d_ij</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">d_ij</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">)</span>  <span class="c1"># hindari pembagian 0</span>
                <span class="n">d_ik</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">d_ik</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">)</span>
                <span class="n">denom</span> <span class="o">+=</span> <span class="p">(</span><span class="n">d_ij</span> <span class="o">/</span> <span class="n">d_ik</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">new_U</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">denom</span>
    <span class="k">return</span> <span class="n">new_U</span>

<span class="c1"># Fungsi: Hitung fungsi objektif</span>
<span class="k">def</span><span class="w"> </span><span class="nf">objective_function</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">J</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">centroids</span><span class="p">)):</span>
            <span class="n">dist_sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="n">J</span> <span class="o">+=</span> <span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">dist_sq</span>
    <span class="k">return</span> <span class="n">J</span>

<span class="c1"># Langkah 3: Iterasi hingga konvergen</span>
<span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">update_centroids</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">new_U</span> <span class="o">=</span> <span class="n">update_membership</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">objective_function</span><span class="p">(</span><span class="n">new_U</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">delta_U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">new_U</span> <span class="o">-</span> <span class="n">U</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iterasi </span><span class="si">{</span><span class="n">iteration</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Centroid:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">centroids</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matriks Keanggotaan (U):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">new_U</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fungsi Objektif (J):&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Perubahan Maksimum Delta U:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">delta_U</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">delta_U</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úÖ Konvergen pada iterasi ke-</span><span class="si">{</span><span class="n">iteration</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">break</span>

    <span class="n">U</span> <span class="o">=</span> <span class="n">new_U</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ùå Tidak konvergen hingga iterasi maksimum.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iterasi 1
Centroid: [3.392  6.1333]
Matriks Keanggotaan (U):
 [[0.8981 0.1019]
 [0.9249 0.0751]
 [0.3319 0.6681]
 [0.141  0.859 ]]
Fungsi Objektif (J): 5.9336
Perubahan Maksimum Delta U: 0.324877
----------------------------------------
Iterasi 2
Centroid: [3.2056 6.8137]
Matriks Keanggotaan (U):
 [[0.941  0.059 ]
 [0.9262 0.0738]
 [0.5053 0.4947]
 [0.0577 0.9423]]
Fungsi Objektif (J): 4.9054
Perubahan Maksimum Delta U: 0.173454
----------------------------------------
Iterasi 3
Centroid: [3.2496 7.3196]
Matriks Keanggotaan (U):
 [[0.9477 0.0523]
 [0.9514 0.0486]
 [0.6372 0.3628]
 [0.0201 0.9799]]
Fungsi Objektif (J): 4.4214
Perubahan Maksimum Delta U: 0.131827
----------------------------------------
Iterasi 4
Centroid: [3.3715 7.6164]
Matriks Keanggotaan (U):
 [[0.9437 0.0563]
 [0.9707 0.0293]
 [0.7208 0.2792]
 [0.0068 0.9932]]
Fungsi Objektif (J): 4.2162
Perubahan Maksimum Delta U: 0.083608
----------------------------------------
Iterasi 5
Centroid: [3.4637 7.7601]
Matriks Keanggotaan (U):
 [[0.9393 0.0607]
 [0.9801 0.0199]
 [0.7635 0.2365]
 [0.0028 0.9972]]
Fungsi Objektif (J): 4.1537
Perubahan Maksimum Delta U: 0.042694
----------------------------------------
Iterasi 6
Centroid: [3.5128 7.8184]
Matriks Keanggotaan (U):
 [[0.9367 0.0633]
 [0.984  0.016 ]
 [0.7822 0.2178]
 [0.0016 0.9984]]
Fungsi Objektif (J): 4.1402
Perubahan Maksimum Delta U: 0.018733
----------------------------------------
Iterasi 7
Centroid: [3.5349 7.8403]
Matriks Keanggotaan (U):
 [[0.9354 0.0646]
 [0.9855 0.0145]
 [0.7899 0.2101]
 [0.0013 0.9987]]
Fungsi Objektif (J): 4.1378
Perubahan Maksimum Delta U: 0.007649
----------------------------------------
‚úÖ Konvergen pada iterasi ke-7
</pre></div>
</div>
</div>
</div>
</section>
<section id="implementasi-fuzzy-c-means-clustering-untuk-data-iris-3cluster">
<h2><strong>Implementasi Fuzzy C-Means Clustering Untuk data Iris (3Cluster)</strong><a class="headerlink" href="#implementasi-fuzzy-c-means-clustering-untuk-data-iris-3cluster" title="Link to this heading">#</a></h2>
<section id="inisialisasi-data-iris-dan-parameter">
<h3><strong>inisialisasi Data Iris dan Parameter</strong><a class="headerlink" href="#inisialisasi-data-iris-dan-parameter" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Fungsi ambil data Iris dan atur ulang kolom</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_iris_data</span><span class="p">():</span>
    <span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="o">.</span><span class="n">from_codes</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># ID dimulai dari 1</span>

    <span class="c1"># Susun ulang kolom: id, class, lalu fitur</span>
    <span class="n">columns_order</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;class&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">columns_order</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Ambil data</span>
<span class="n">df_iris</span> <span class="o">=</span> <span class="n">get_iris_data</span><span class="p">()</span>

<span class="c1"># Muat data Iris</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># Semua fitur: shape (150, 4)</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span>

<span class="c1"># Cetak tanpa indeks</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_iris</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Parameter FCM</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>                  <span class="c1"># Jumlah cluster</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">2.0</span>                <span class="c1"># Derajat fuzziness</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">100</span>         <span class="c1"># Maksimum iterasi</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.01</span>         <span class="c1"># Ambang batas konvergensi</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>         <span class="c1"># Jumlah data (150)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>         <span class="c1"># Jumlah fitur (4)</span>

<span class="c1"># Inisialisasi keanggotaan acak (jumlah baris = data, kolom = cluster)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>
<span class="c1"># Cetak semua parameter</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üìå Parameter FCM:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah data (n)        : </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah fitur (d)       : </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">feature_names</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah cluster (k)     : </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fuzziness (m)          : </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maksimum iterasi       : </span><span class="si">{</span><span class="n">max_iter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ambang konvergensi     : </span><span class="si">{</span><span class="n">epsilon</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape matriks keanggotaan U: </span><span class="si">{</span><span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> id      class  sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm)
  1     setosa                5.1               3.5                1.4               0.2
  2     setosa                4.9               3.0                1.4               0.2
  3     setosa                4.7               3.2                1.3               0.2
  4     setosa                4.6               3.1                1.5               0.2
  5     setosa                5.0               3.6                1.4               0.2
  6     setosa                5.4               3.9                1.7               0.4
  7     setosa                4.6               3.4                1.4               0.3
  8     setosa                5.0               3.4                1.5               0.2
  9     setosa                4.4               2.9                1.4               0.2
 10     setosa                4.9               3.1                1.5               0.1
 11     setosa                5.4               3.7                1.5               0.2
 12     setosa                4.8               3.4                1.6               0.2
 13     setosa                4.8               3.0                1.4               0.1
 14     setosa                4.3               3.0                1.1               0.1
 15     setosa                5.8               4.0                1.2               0.2
 16     setosa                5.7               4.4                1.5               0.4
 17     setosa                5.4               3.9                1.3               0.4
 18     setosa                5.1               3.5                1.4               0.3
 19     setosa                5.7               3.8                1.7               0.3
 20     setosa                5.1               3.8                1.5               0.3
 21     setosa                5.4               3.4                1.7               0.2
 22     setosa                5.1               3.7                1.5               0.4
 23     setosa                4.6               3.6                1.0               0.2
 24     setosa                5.1               3.3                1.7               0.5
 25     setosa                4.8               3.4                1.9               0.2
 26     setosa                5.0               3.0                1.6               0.2
 27     setosa                5.0               3.4                1.6               0.4
 28     setosa                5.2               3.5                1.5               0.2
 29     setosa                5.2               3.4                1.4               0.2
 30     setosa                4.7               3.2                1.6               0.2
 31     setosa                4.8               3.1                1.6               0.2
 32     setosa                5.4               3.4                1.5               0.4
 33     setosa                5.2               4.1                1.5               0.1
 34     setosa                5.5               4.2                1.4               0.2
 35     setosa                4.9               3.1                1.5               0.2
 36     setosa                5.0               3.2                1.2               0.2
 37     setosa                5.5               3.5                1.3               0.2
 38     setosa                4.9               3.6                1.4               0.1
 39     setosa                4.4               3.0                1.3               0.2
 40     setosa                5.1               3.4                1.5               0.2
 41     setosa                5.0               3.5                1.3               0.3
 42     setosa                4.5               2.3                1.3               0.3
 43     setosa                4.4               3.2                1.3               0.2
 44     setosa                5.0               3.5                1.6               0.6
 45     setosa                5.1               3.8                1.9               0.4
 46     setosa                4.8               3.0                1.4               0.3
 47     setosa                5.1               3.8                1.6               0.2
 48     setosa                4.6               3.2                1.4               0.2
 49     setosa                5.3               3.7                1.5               0.2
 50     setosa                5.0               3.3                1.4               0.2
 51 versicolor                7.0               3.2                4.7               1.4
 52 versicolor                6.4               3.2                4.5               1.5
 53 versicolor                6.9               3.1                4.9               1.5
 54 versicolor                5.5               2.3                4.0               1.3
 55 versicolor                6.5               2.8                4.6               1.5
 56 versicolor                5.7               2.8                4.5               1.3
 57 versicolor                6.3               3.3                4.7               1.6
 58 versicolor                4.9               2.4                3.3               1.0
 59 versicolor                6.6               2.9                4.6               1.3
 60 versicolor                5.2               2.7                3.9               1.4
 61 versicolor                5.0               2.0                3.5               1.0
 62 versicolor                5.9               3.0                4.2               1.5
 63 versicolor                6.0               2.2                4.0               1.0
 64 versicolor                6.1               2.9                4.7               1.4
 65 versicolor                5.6               2.9                3.6               1.3
 66 versicolor                6.7               3.1                4.4               1.4
 67 versicolor                5.6               3.0                4.5               1.5
 68 versicolor                5.8               2.7                4.1               1.0
 69 versicolor                6.2               2.2                4.5               1.5
 70 versicolor                5.6               2.5                3.9               1.1
 71 versicolor                5.9               3.2                4.8               1.8
 72 versicolor                6.1               2.8                4.0               1.3
 73 versicolor                6.3               2.5                4.9               1.5
 74 versicolor                6.1               2.8                4.7               1.2
 75 versicolor                6.4               2.9                4.3               1.3
 76 versicolor                6.6               3.0                4.4               1.4
 77 versicolor                6.8               2.8                4.8               1.4
 78 versicolor                6.7               3.0                5.0               1.7
 79 versicolor                6.0               2.9                4.5               1.5
 80 versicolor                5.7               2.6                3.5               1.0
 81 versicolor                5.5               2.4                3.8               1.1
 82 versicolor                5.5               2.4                3.7               1.0
 83 versicolor                5.8               2.7                3.9               1.2
 84 versicolor                6.0               2.7                5.1               1.6
 85 versicolor                5.4               3.0                4.5               1.5
 86 versicolor                6.0               3.4                4.5               1.6
 87 versicolor                6.7               3.1                4.7               1.5
 88 versicolor                6.3               2.3                4.4               1.3
 89 versicolor                5.6               3.0                4.1               1.3
 90 versicolor                5.5               2.5                4.0               1.3
 91 versicolor                5.5               2.6                4.4               1.2
 92 versicolor                6.1               3.0                4.6               1.4
 93 versicolor                5.8               2.6                4.0               1.2
 94 versicolor                5.0               2.3                3.3               1.0
 95 versicolor                5.6               2.7                4.2               1.3
 96 versicolor                5.7               3.0                4.2               1.2
 97 versicolor                5.7               2.9                4.2               1.3
 98 versicolor                6.2               2.9                4.3               1.3
 99 versicolor                5.1               2.5                3.0               1.1
100 versicolor                5.7               2.8                4.1               1.3
101  virginica                6.3               3.3                6.0               2.5
102  virginica                5.8               2.7                5.1               1.9
103  virginica                7.1               3.0                5.9               2.1
104  virginica                6.3               2.9                5.6               1.8
105  virginica                6.5               3.0                5.8               2.2
106  virginica                7.6               3.0                6.6               2.1
107  virginica                4.9               2.5                4.5               1.7
108  virginica                7.3               2.9                6.3               1.8
109  virginica                6.7               2.5                5.8               1.8
110  virginica                7.2               3.6                6.1               2.5
111  virginica                6.5               3.2                5.1               2.0
112  virginica                6.4               2.7                5.3               1.9
113  virginica                6.8               3.0                5.5               2.1
114  virginica                5.7               2.5                5.0               2.0
115  virginica                5.8               2.8                5.1               2.4
116  virginica                6.4               3.2                5.3               2.3
117  virginica                6.5               3.0                5.5               1.8
118  virginica                7.7               3.8                6.7               2.2
119  virginica                7.7               2.6                6.9               2.3
120  virginica                6.0               2.2                5.0               1.5
121  virginica                6.9               3.2                5.7               2.3
122  virginica                5.6               2.8                4.9               2.0
123  virginica                7.7               2.8                6.7               2.0
124  virginica                6.3               2.7                4.9               1.8
125  virginica                6.7               3.3                5.7               2.1
126  virginica                7.2               3.2                6.0               1.8
127  virginica                6.2               2.8                4.8               1.8
128  virginica                6.1               3.0                4.9               1.8
129  virginica                6.4               2.8                5.6               2.1
130  virginica                7.2               3.0                5.8               1.6
131  virginica                7.4               2.8                6.1               1.9
132  virginica                7.9               3.8                6.4               2.0
133  virginica                6.4               2.8                5.6               2.2
134  virginica                6.3               2.8                5.1               1.5
135  virginica                6.1               2.6                5.6               1.4
136  virginica                7.7               3.0                6.1               2.3
137  virginica                6.3               3.4                5.6               2.4
138  virginica                6.4               3.1                5.5               1.8
139  virginica                6.0               3.0                4.8               1.8
140  virginica                6.9               3.1                5.4               2.1
141  virginica                6.7               3.1                5.6               2.4
142  virginica                6.9               3.1                5.1               2.3
143  virginica                5.8               2.7                5.1               1.9
144  virginica                6.8               3.2                5.9               2.3
145  virginica                6.7               3.3                5.7               2.5
146  virginica                6.7               3.0                5.2               2.3
147  virginica                6.3               2.5                5.0               1.9
148  virginica                6.5               3.0                5.2               2.0
149  virginica                6.2               3.4                5.4               2.3
150  virginica                5.9               3.0                5.1               1.8

üìå Parameter FCM:
Jumlah data (n)        : 150
Jumlah fitur (d)       : 4 (sepal length (cm), sepal width (cm), petal length (cm), petal width (cm))
Jumlah cluster (k)     : 3
Fuzziness (m)          : 2.0
Maksimum iterasi       : 100
Ambang konvergensi     : 0.01
Shape matriks keanggotaan U: (150, 3)
</pre></div>
</div>
</div>
</div>
</section>
<section id="inisialisasi-derajat-keanggotaan">
<h3><strong>Inisialisasi derajat Keanggotaan</strong><a class="headerlink" href="#inisialisasi-derajat-keanggotaan" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tambahkan ID ke matriks keanggotaan dan pindahkan ke kolom paling kiri</span>
<span class="n">df_U</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Cluster_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)])</span>
<span class="n">df_U</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">df_U</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># ID dimulai dari 1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Matriks Keanggotaan Awal (U) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_U</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Matriks Keanggotaan Awal (U) ===
 id  Cluster_1  Cluster_2  Cluster_3
  1   0.342857   0.174379   0.482764
  2   0.296277   0.092235   0.611488
  3   0.243721   0.519590   0.236689
  4   0.551437   0.039810   0.408752
  5   0.312072   0.266559   0.421370
  6   0.925085   0.063720   0.011195
  7   0.383428   0.381779   0.234792
  8   0.323704   0.486776   0.189520
  9   0.240677   0.672465   0.086857
 10   0.173370   0.224212   0.602418
 11   0.722605   0.263430   0.013965
 12   0.278838   0.612618   0.108544
 13   0.353059   0.231310   0.415631
 14   0.238531   0.040982   0.720487
 15   0.350853   0.280662   0.368485
 16   0.380720   0.542343   0.076937
 17   0.267268   0.540227   0.192505
 18   0.595876   0.332394   0.071729
 19   0.011232   0.469972   0.518796
 20   0.244484   0.725044   0.030472
 21   0.639799   0.090579   0.269622
 22   0.404714   0.193268   0.402018
 23   0.646571   0.304123   0.049306
 24   0.070074   0.511820   0.418106
 25   0.553468   0.072200   0.374332
 26   0.203144   0.180698   0.616158
 27   0.442911   0.369828   0.187261
 28   0.244882   0.116137   0.638981
 29   0.588138   0.190503   0.221359
 30   0.198625   0.533777   0.267598
 31   0.321741   0.392377   0.285882
 32   0.035252   0.866924   0.097824
 33   0.156151   0.781168   0.062681
 34   0.016025   0.557242   0.426734
 35   0.645609   0.286666   0.067725
 36   0.615754   0.349911   0.034335
 37   0.659610   0.081779   0.258611
 38   0.725781   0.167725   0.106495
 39   0.330386   0.377736   0.291878
 40   0.483234   0.212241   0.304526
 41   0.292804   0.374119   0.333077
 42   0.417857   0.169565   0.412577
 43   0.620935   0.332737   0.046328
 44   0.035793   0.359331   0.604876
 45   0.737337   0.180485   0.082178
 46   0.030910   0.783369   0.185721
 47   0.129986   0.441515   0.428499
 48   0.021651   0.846329   0.132020
 49   0.673327   0.264193   0.062480
 50   0.191008   0.488963   0.320029
 51   0.410363   0.140136   0.449501
 52   0.477420   0.122264   0.400316
 53   0.128960   0.053731   0.817309
 54   0.406935   0.034133   0.558932
 55   0.128944   0.202626   0.668430
 56   0.119118   0.360265   0.520617
 57   0.450475   0.120821   0.428704
 58   0.699942   0.237800   0.062258
 59   0.280621   0.301341   0.418038
 60   0.197540   0.490483   0.311978
 61   0.428731   0.394916   0.176353
 62   0.603780   0.062207   0.334013
 63   0.058202   0.718084   0.223714
 64   0.084383   0.444308   0.471309
 65   0.370762   0.035671   0.593567
 66   0.345176   0.097267   0.557557
 67   0.901945   0.014369   0.083687
 68   0.067960   0.812526   0.119515
 69   0.275068   0.193008   0.531924
 70   0.359404   0.368976   0.271620
 71   0.069945   0.052632   0.877423
 72   0.442432   0.247582   0.309986
 73   0.298528   0.195482   0.505990
 74   0.249559   0.005155   0.745286
 75   0.312419   0.102158   0.585424
 76   0.889410   0.002448   0.108142
 77   0.052876   0.204909   0.742215
 78   0.236251   0.634115   0.129634
 79   0.293087   0.057465   0.649448
 80   0.708918   0.081380   0.209701
 81   0.418909   0.184285   0.396806
 82   0.350925   0.525923   0.123152
 83   0.056609   0.016062   0.927329
 84   0.419047   0.264644   0.316309
 85   0.122452   0.732974   0.144574
 86   0.080015   0.496085   0.423900
 87   0.574449   0.299520   0.126031
 88   0.625929   0.334323   0.039748
 89   0.425831   0.342102   0.232067
 90   0.337029   0.089699   0.573272
 91   0.144080   0.143789   0.712131
 92   0.399467   0.570064   0.030469
 93   0.080927   0.382898   0.536174
 94   0.179296   0.359276   0.461428
 95   0.666332   0.237908   0.095760
 96   0.007380   0.032491   0.960130
 97   0.162699   0.145411   0.691890
 98   0.234353   0.620503   0.145144
 99   0.525525   0.407244   0.067232
100   0.318215   0.405283   0.276501
101   0.409787   0.270542   0.319671
102   0.270632   0.633659   0.095709
103   0.129767   0.780994   0.089238
104   0.223698   0.221813   0.554489
105   0.222637   0.533995   0.243368
106   0.112878   0.175673   0.711449
107   0.916488   0.051929   0.031583
108   0.747966   0.169603   0.082431
109   0.024051   0.020980   0.954969
110   0.191712   0.245776   0.562512
111   0.141607   0.421029   0.437365
112   0.269412   0.024342   0.706246
113   0.699659   0.291561   0.008779
114   0.069372   0.101073   0.829555
115   0.172511   0.682379   0.145110
116   0.716616   0.248774   0.034609
117   0.544026   0.201189   0.254785
118   0.753229   0.206246   0.040526
119   0.699117   0.297822   0.003062
120   0.066824   0.452255   0.480921
121   0.457776   0.254507   0.287717
122   0.693186   0.177603   0.129211
123   0.681995   0.163799   0.154205
124   0.436408   0.412704   0.150889
125   0.580036   0.369817   0.050147
126   0.010909   0.988598   0.000494
127   0.284421   0.200469   0.515111
128   0.309083   0.337212   0.353704
129   0.322841   0.573292   0.103868
130   0.610336   0.185759   0.203905
131   0.099165   0.264668   0.636167
132   0.526999   0.433227   0.039774
133   0.039046   0.434383   0.526571
134   0.088871   0.483922   0.427207
135   0.454041   0.362552   0.183407
136   0.046636   0.314996   0.638368
137   0.249241   0.009360   0.741399
138   0.419716   0.019276   0.561008
139   0.515007   0.020186   0.464807
140   0.393714   0.471954   0.134332
141   0.556699   0.045501   0.397799
142   0.179054   0.394641   0.426305
143   0.059346   0.770746   0.169908
144   0.014022   0.788851   0.197128
145   0.351967   0.030820   0.617213
146   0.375326   0.103505   0.521170
147   0.154045   0.441206   0.404749
148   0.482838   0.450135   0.067027
149   0.154680   0.074739   0.770581
150   0.645738   0.210992   0.143270
</pre></div>
</div>
</div>
</div>
</section>
<section id="hitung-centroid-berdasarkan-matriks-keanggotaan-u">
<h3><strong>Hitung centroid berdasarkan matriks keanggotaan U</strong><a class="headerlink" href="#hitung-centroid-berdasarkan-matriks-keanggotaan-u" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">calculate_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">um</span> <span class="o">=</span> <span class="n">U</span> <span class="o">**</span> <span class="n">m</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="p">(</span><span class="n">um</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">um</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">centroids</span>

<span class="n">centroids</span> <span class="o">=</span> <span class="n">calculate_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Centroid Awal (Iterasi ke-1) ===&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">centroid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">centroids</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Centroid Cluster </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">centroid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Centroid Awal (Iterasi ke-1) ===
Centroid Cluster 1: [5.84023969 3.10466505 3.71489189 1.17357574]
Centroid Cluster 2: [5.77327727 3.10299993 3.59397188 1.13034579]
Centroid Cluster 3: [5.978474   2.97448741 4.13011578 1.34964441]
</pre></div>
</div>
</div>
</div>
</section>
<section id="update-matriks-keanggotaan-u">
<h3><strong>Update matriks keanggotaan U</strong><a class="headerlink" href="#update-matriks-keanggotaan-u" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update_membership</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">U_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
            <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">distances</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="n">distances</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="n">U_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">denom</span>
    <span class="k">return</span> <span class="n">U_new</span>

<span class="c1"># Perbarui keanggotaan</span>
<span class="n">U_new</span> <span class="o">=</span> <span class="n">update_membership</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

<span class="c1"># Buat DataFrame dan atur urutan kolom (id di paling kiri)</span>
<span class="n">df_U_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">U_new</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Cluster_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)])</span>
<span class="n">df_U_new</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">df_U_new</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Tambahkan ID di kolom pertama</span>

<span class="c1"># Cetak hasil</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Matriks Keanggotaan Baru (Setelah Iterasi ke-1) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_U_new</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Matriks Keanggotaan Baru (Setelah Iterasi ke-1) ===
 id  Cluster_1  Cluster_2  Cluster_3
  1   0.353568   0.394088   0.252344
  2   0.352025   0.392905   0.255070
  3   0.351626   0.390198   0.258176
  4   0.351701   0.392299   0.255999
  5   0.353431   0.393190   0.253379
  6   0.356363   0.399279   0.244359
  7   0.352083   0.391472   0.256445
  8   0.353549   0.395857   0.250593
  9   0.350316   0.387926   0.261758
 10   0.352491   0.394129   0.253379
 11   0.354910   0.395417   0.249673
 12   0.353301   0.396164   0.250535
 13   0.351649   0.391344   0.257007
 14   0.349503   0.383146   0.267351
 15   0.353881   0.386095   0.260024
 16   0.355170   0.387216   0.257614
 17   0.354267   0.391269   0.254463
 18   0.353693   0.394895   0.251412
 19   0.356774   0.398551   0.244675
 20   0.354409   0.394900   0.250691
 21   0.355487   0.401702   0.242812
 22   0.354464   0.396465   0.249071
 23   0.350975   0.384643   0.264382
 24   0.354778   0.404154   0.241068
 25   0.354329   0.401897   0.243774
 26   0.352964   0.397492   0.249544
 27   0.354178   0.399778   0.246044
 28   0.354242   0.396436   0.249322
 29   0.353654   0.394716   0.251630
 30   0.352558   0.395259   0.252182
 31   0.352639   0.396135   0.251226
 32   0.354815   0.398914   0.246271
 33   0.354301   0.390413   0.255286
 34   0.354475   0.388355   0.257170
 35   0.352617   0.395121   0.252262
 36   0.352046   0.390339   0.257615
 37   0.353906   0.392382   0.253713
 38   0.353020   0.391782   0.255198
 39   0.350324   0.387016   0.262660
 40   0.353824   0.396405   0.249771
 41   0.353028   0.392491   0.254481
 42   0.348557   0.383368   0.268075
 43   0.350741   0.387453   0.261806
 44   0.354495   0.400553   0.244952
 45   0.356402   0.404144   0.239453
 46   0.351839   0.392902   0.255259
 47   0.354700   0.395903   0.249396
 48   0.351635   0.390895   0.257470
 49   0.354698   0.395408   0.249894
 50   0.352983   0.394056   0.252962
 51   0.284368   0.240409   0.475223
 52   0.224048   0.172251   0.603701
 53   0.275789   0.233451   0.490760
 54   0.315857   0.297658   0.386484
 55   0.227285   0.182231   0.590485
 56   0.208376   0.163925   0.627698
 57   0.241233   0.192125   0.566642
 58   0.350811   0.408230   0.240959
 59   0.243332   0.195503   0.561165
 60   0.345149   0.346079   0.308772
 61   0.343230   0.373482   0.283288
 62   0.082900   0.055686   0.861414
 63   0.312211   0.284432   0.403357
 64   0.198529   0.155509   0.645962
 65   0.386831   0.497922   0.115246
 66   0.259319   0.206615   0.534067
 67   0.227120   0.180123   0.592758
 68   0.304808   0.240260   0.454933
 69   0.254998   0.217925   0.527077
 70   0.344150   0.326389   0.329461
 71   0.246669   0.202426   0.550905
 72   0.177203   0.116373   0.706424
 73   0.246727   0.207447   0.545825
 74   0.213831   0.169576   0.616592
 75   0.197316   0.146471   0.656213
 76   0.239164   0.187220   0.573615
 77   0.264695   0.222067   0.513238
 78   0.266151   0.224848   0.509001
 79   0.153136   0.115253   0.731611
 80   0.369059   0.455365   0.175576
 81   0.347636   0.354855   0.297509
 82   0.354838   0.381902   0.263260
 83   0.349259   0.267438   0.383303
 84   0.251958   0.213466   0.534576
 85   0.269326   0.225610   0.505064
 86   0.240256   0.185313   0.574432
 87   0.258150   0.211312   0.530538
 88   0.252444   0.211994   0.535563
 89   0.303245   0.217046   0.479709
 90   0.318690   0.291822   0.389488
 91   0.272806   0.233450   0.493744
 92   0.179077   0.136020   0.684903
 93   0.294201   0.235044   0.470754
 94   0.350225   0.404749   0.245027
 95   0.256677   0.206211   0.537113
 96   0.237241   0.163000   0.599760
 97   0.193571   0.136823   0.669606
 98   0.127094   0.089687   0.783218
 99   0.352895   0.431100   0.216005
100   0.237539   0.172098   0.590363
101   0.299068   0.270945   0.429987
102   0.263355   0.227468   0.509176
103   0.297598   0.268024   0.434378
104   0.279721   0.245163   0.475116
105   0.290865   0.259689   0.449446
106   0.308184   0.284264   0.407552
107   0.308252   0.290825   0.400922
108   0.303061   0.276315   0.420624
109   0.289176   0.258543   0.452281
110   0.306693   0.280362   0.412945
111   0.273137   0.233563   0.493300
112   0.270682   0.234613   0.494704
113   0.287322   0.253637   0.459041
114   0.269433   0.236219   0.494348
115   0.281280   0.249023   0.469697
116   0.284250   0.249211   0.466539
117   0.279124   0.243186   0.477690
118   0.312974   0.290361   0.396664
119   0.310044   0.288386   0.401570
120   0.266021   0.232248   0.501730
121   0.295739   0.264810   0.439451
122   0.266823   0.231108   0.502069
123   0.308932   0.285831   0.405237
124   0.245898   0.205897   0.548205
125   0.292833   0.260299   0.446868
126   0.300522   0.271124   0.428354
127   0.233941   0.192596   0.573463
128   0.241660   0.199511   0.558830
129   0.283476   0.250653   0.465870
130   0.297036   0.266061   0.436902
131   0.301947   0.274661   0.423393
132   0.313130   0.289713   0.397158
133   0.285034   0.252785   0.462181
134   0.252348   0.211891   0.535761
135   0.279700   0.246465   0.473835
136   0.306485   0.281044   0.412471
137   0.293942   0.262330   0.443728
138   0.279133   0.242836   0.478031
139   0.233718   0.191064   0.575217
140   0.288464   0.254168   0.457368
141   0.292571   0.261127   0.446302
142   0.288190   0.253221   0.458589
143   0.263355   0.227468   0.509176
144   0.297217   0.267468   0.435315
145   0.297101   0.266953   0.435946
146   0.283978   0.249057   0.466965
147   0.260138   0.223339   0.516524
148   0.272268   0.234349   0.493383
149   0.289207   0.255266   0.455527
150   0.258444   0.219085   0.522471
</pre></div>
</div>
</div>
</div>
</section>
<section id="hitung-fungsi-objektif-dan-cek-konvergensi">
<h3><strong>Hitung Fungsi Objektif dan Cek Konvergensi</strong><a class="headerlink" href="#hitung-fungsi-objektif-dan-cek-konvergensi" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fungsi objektif</span>
<span class="k">def</span><span class="w"> </span><span class="nf">objective_function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">J</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">J</span> <span class="o">+=</span> <span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dist</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">J</span>

<span class="n">J</span> <span class="o">=</span> <span class="n">objective_function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">U_new</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=== Fungsi Objektif (J) Iterasi ke-1 ===</span><span class="se">\n</span><span class="s2">J = </span><span class="si">{</span><span class="n">J</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Cek konvergensi</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">U_new</span> <span class="o">-</span> <span class="n">U</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Perubahan matriks keanggotaan (delta) = </span><span class="si">{</span><span class="n">delta</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ Matriks keanggotaan sudah konvergen (berhenti iterasi).&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ùå Belum konvergen, lanjut ke iterasi berikutnya.&quot;</span><span class="p">)</span>

<span class="c1"># Lakukan PCA untuk mereduksi fitur dari 4 ke 2 dimensi</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Tentukan cluster dengan keanggotaan tertinggi tiap data (hard clustering)</span>
<span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">U_new</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Plot data hasil PCA, warna berdasarkan cluster</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="n">cluster_points</span> <span class="o">=</span> <span class="n">X_pca</span><span class="p">[</span><span class="n">cluster_labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cluster_points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">cluster_points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Cluster </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Hasil Clustering FCM Iris Dataset (Visualisasi PCA)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;PCA 1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;PCA 2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Fungsi Objektif (J) Iterasi ke-1 ===
J = 219.7132

Perubahan matriks keanggotaan (delta) = 5.163894
‚ùå Belum konvergen, lanjut ke iterasi berikutnya.
</pre></div>
</div>
<img alt="_images/0ca75fbebe5c5737b1df582212ec083eec80639a48b5091b9a10891bf3f1a96a.png" src="_images/0ca75fbebe5c5737b1df582212ec083eec80639a48b5091b9a10891bf3f1a96a.png" />
</div>
</div>
<p><strong>Karena dari perhitungan diatas belum mencapai konvergensi maka Akan dilakukan perhitungan ulang pada iterasi hingga mencapai konvergensi</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === Fungsi bantu ===</span>
<span class="k">def</span><span class="w"> </span><span class="nf">euclidean_distance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">um</span> <span class="o">=</span> <span class="n">U</span> <span class="o">**</span> <span class="n">m</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="p">(</span><span class="n">um</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">um</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">centroids</span>

<span class="k">def</span><span class="w"> </span><span class="nf">update_membership</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">U_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
            <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">distances</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="n">distances</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="n">U_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">denom</span>
    <span class="k">return</span> <span class="n">U_new</span>

<span class="k">def</span><span class="w"> </span><span class="nf">objective_function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">J</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">J</span> <span class="o">+=</span> <span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dist</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">J</span>

<span class="c1"># === Load data Iris ===</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>
<span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Inisialisasi keanggotaan acak (dengan baris = data, kolom = cluster)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># === Iterasi ===</span>
<span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">====== ITERASI KE-</span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> ======&quot;</span><span class="p">)</span>

    <span class="c1"># Hitung centroid</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">calculate_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìå Centroid:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">centroids</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cluster </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Update keanggotaan</span>
    <span class="n">U_new</span> <span class="o">=</span> <span class="n">update_membership</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìå Matriks Keanggotaan (5 data pertama):&quot;</span><span class="p">)</span>
    <span class="n">df_U_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">U_new</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df_U_new</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

    <span class="c1"># Hitung fungsi objektif</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">objective_function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">U_new</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìå Fungsi Objektif (J): </span><span class="si">{</span><span class="n">J</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Cek konvergensi</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">U_new</span> <span class="o">-</span> <span class="n">U</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìå Perubahan keanggotaan (delta): </span><span class="si">{</span><span class="n">delta</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">‚úÖ Konvergensi tercapai. Iterasi dihentikan.&quot;</span><span class="p">)</span>
        <span class="k">break</span>

    <span class="n">U</span> <span class="o">=</span> <span class="n">U_new</span>  <span class="c1"># simpan untuk iterasi berikutnya</span>

<span class="c1"># === Hasil akhir ===</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">======== HASIL AKHIR ========&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üìå Centroid akhir:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">centroids</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cluster </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìå Keanggotaan akhir (5 data pertama):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_U_new</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìå Fungsi Objektif akhir: </span><span class="si">{</span><span class="n">J</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>====== ITERASI KE-1 ======

üìå Centroid:
Cluster 1: [6.06673919 3.00422155 4.16771426 1.37476747]
Cluster 2: [5.85048499 3.06034261 3.8023977  1.20959388]
Cluster 3: [5.63287974 3.1153372  3.26640646 0.99226272]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.217205 0.294142 0.488653
0.218217 0.294863 0.486920
0.223350 0.298084 0.478566
0.219065 0.296063 0.484872
0.218886 0.295383 0.485731

üìå Fungsi Objektif (J): 207.462652
üìå Perubahan keanggotaan (delta): 5.720933

====== ITERASI KE-2 ======

üìå Centroid:
Cluster 1: [6.21068093 2.95698086 4.64895615 1.56593278]
Cluster 2: [5.82662119 3.00516876 3.82861947 1.22327775]
Cluster 3: [5.2690505  3.25460263 2.26381149 0.58115577]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.058691 0.106079 0.835230
0.063467 0.115005 0.821528
0.072616 0.128017 0.799367
0.067576 0.121863 0.810561
0.062521 0.112008 0.825470

üìå Fungsi Objektif (J): 123.393639
üìå Perubahan keanggotaan (delta): 4.076931

====== ITERASI KE-3 ======

üìå Centroid:
Cluster 1: [6.4044565  2.94065361 5.0882252  1.76980103]
Cluster 2: [5.80453386 2.76582206 4.15657737 1.32046313]
Cluster 3: [5.03232543 3.40524751 1.54991165 0.28092839]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.002339 0.004277 0.993384
0.011126 0.020972 0.967902
0.010854 0.019842 0.969304
0.014861 0.028021 0.957118
0.003643 0.006600 0.989757

üìå Fungsi Objektif (J): 70.083851
üìå Perubahan keanggotaan (delta): 3.008571

====== ITERASI KE-4 ======

üìå Centroid:
Cluster 1: [6.55236452 2.97690628 5.33906123 1.90803185]
Cluster 2: [5.78729852 2.72566773 4.21548198 1.32272435]
Cluster 3: [5.00690117 3.41749027 1.48277921 0.25307865]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.001204 0.002442 0.996354
0.008975 0.018900 0.972125
0.007643 0.015544 0.976812
0.012073 0.025468 0.962459
0.002014 0.004045 0.993940

üìå Fungsi Objektif (J): 63.341534
üìå Perubahan keanggotaan (delta): 1.333176

====== ITERASI KE-5 ======

üìå Centroid:
Cluster 1: [6.64111276 3.00846771 5.46886063 1.97457743]
Cluster 2: [5.80342973 2.729585   4.24136474 1.33430962]
Cluster 3: [5.0044585  3.41713018 1.47900781 0.25169828]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.001112 0.002376 0.996512
0.008297 0.018406 0.973297
0.007016 0.015005 0.977979
0.011166 0.024805 0.964029
0.001852 0.003914 0.994233

üìå Fungsi Objektif (J): 61.552810
üìå Perubahan keanggotaan (delta): 0.728302

====== ITERASI KE-6 ======

üìå Centroid:
Cluster 1: [6.69145304 3.02591396 5.53794674 2.00708894]
Cluster 2: [5.82621666 2.73774917 4.27374176 1.3512859 ]
Cluster 3: [5.00407403 3.416547   1.47922351 0.25187142]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.001082 0.002343 0.996575
0.007980 0.017916 0.974105
0.006758 0.014629 0.978613
0.010743 0.024150 0.965107
0.001798 0.003851 0.994351

üìå Fungsi Objektif (J): 60.946776
üìå Perubahan keanggotaan (delta): 0.455904

====== ITERASI KE-7 ======

üìå Centroid:
Cluster 1: [6.7214824  3.0358165  5.57785699 2.02486587]
Cluster 2: [5.84578167 2.7450818  4.30176907 1.36563446]
Cluster 3: [5.00398004 3.41592531 1.48001314 0.25226072]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.001072 0.002323 0.996605
0.007802 0.017512 0.974686
0.006623 0.014342 0.979035
0.010508 0.023612 0.965880
0.001778 0.003812 0.994410

üìå Fungsi Objektif (J): 60.696999
üìå Perubahan keanggotaan (delta): 0.299058

====== ITERASI KE-8 ======

üìå Centroid:
Cluster 1: [6.74031052 3.04182176 5.60247394 2.03546672]
Cluster 2: [5.86016356 2.75048671 4.32240595 1.37611523]
Cluster 3: [5.00395152 3.41538228 1.4807971  0.25262869]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.001070 0.002314 0.996617
0.007693 0.017221 0.975086
0.006546 0.014141 0.979313
0.010364 0.023225 0.966411
0.001771 0.003791 0.994439

üìå Fungsi Objektif (J): 60.588230
üìå Perubahan keanggotaan (delta): 0.197184

====== ITERASI KE-9 ======

üìå Centroid:
Cluster 1: [6.75243931 3.0456001  5.61815325 2.04204576]
Cluster 2: [5.87005644 2.75417086 4.33662498 1.38333869]
Cluster 3: [5.00394537 3.41496777 1.48142375 0.25291695]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.001070 0.002309 0.996621
0.007624 0.017023 0.975353
0.006498 0.014007 0.979495
0.010273 0.022962 0.966766
0.001768 0.003779 0.994453

üìå Fungsi Objektif (J): 60.540943
üìå Perubahan keanggotaan (delta): 0.129411

====== ITERASI KE-10 ======

üìå Centroid:
Cluster 1: [6.76033358 3.04801445 5.62826291 2.04619632]
Cluster 2: [5.87664902 2.75660176 4.34612668 1.3881789 ]
Cluster 3: [5.00394739 3.4146737  1.48188019 0.25312471]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.001070 0.002307 0.996623
0.007579 0.016892 0.975529
0.006468 0.013919 0.979613
0.010214 0.022788 0.966998
0.001768 0.003772 0.994460

üìå Fungsi Objektif (J): 60.520626
üìå Perubahan keanggotaan (delta): 0.084487

====== ITERASI KE-11 ======

üìå Centroid:
Cluster 1: [6.76548172 3.04956641 5.63480513 2.04883518]
Cluster 2: [5.88097306 2.75818394 4.35237834 1.39137306]
Cluster 3: [5.0039516  3.41447326 1.48219666 0.25326791]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.001071 0.002306 0.996624
0.007550 0.016807 0.975643
0.006449 0.013863 0.979689
0.010176 0.022674 0.967150
0.001768 0.003768 0.994464

üìå Fungsi Objektif (J): 60.511987
üìå Perubahan keanggotaan (delta): 0.054935

====== ITERASI KE-12 ======

üìå Centroid:
Cluster 1: [6.76883455 3.05056625 5.63904059 2.05052061]
Cluster 2: [5.88378628 2.75920782 4.35645734 1.39346244]
Cluster 3: [5.00395565 3.41433966 1.48240996 0.25336409]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.001071 0.002305 0.996624
0.007532 0.016751 0.975717
0.006437 0.013826 0.979737
0.010152 0.022600 0.967248
0.001768 0.003766 0.994467

üìå Fungsi Objektif (J): 60.508341
üìå Perubahan keanggotaan (delta): 0.035620

====== ITERASI KE-13 ======

üìå Centroid:
Cluster 1: [6.77101343 3.05121092 5.64178106 2.05160042]
Cluster 2: [5.88560897 2.75986885 4.35910626 1.39482194]
Cluster 3: [5.00395886 3.41425177 1.48255131 0.25342769]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.001071 0.002305 0.996624
0.007520 0.016715 0.975765
0.006429 0.013802 0.979769
0.010136 0.022552 0.967312
0.001768 0.003764 0.994468

üìå Fungsi Objektif (J): 60.506810
üìå Perubahan keanggotaan (delta): 0.023054

====== ITERASI KE-14 ======

üìå Centroid:
Cluster 1: [6.77242648 3.05162671 5.64355286 2.05229373]
Cluster 2: [5.88678736 2.76029522 4.36082181 1.39570365]
Cluster 3: [5.00396119 3.4141944  1.48264404 0.25346936]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.001072 0.002305 0.996624
0.007512 0.016692 0.975796
0.006424 0.013787 0.979789
0.010126 0.022521 0.967353
0.001768 0.003763 0.994469

üìå Fungsi Objektif (J): 60.506170
üìå Perubahan keanggotaan (delta): 0.014903

====== ITERASI KE-15 ======

üìå Centroid:
Cluster 1: [6.77334139 3.05189491 5.64469762 2.05273954]
Cluster 2: [5.88754836 2.76057016 4.3619311  1.39627433]
Cluster 3: [5.0039628  3.41415712 1.48270448 0.2534965 ]

üìå Matriks Keanggotaan (5 data pertama):
      C1       C2       C3
0.001072 0.002305 0.996624
0.007507 0.016677 0.975816
0.006420 0.013777 0.979802
0.010119 0.022501 0.967379
0.001768 0.003763 0.994469

üìå Fungsi Objektif (J): 60.505902
üìå Perubahan keanggotaan (delta): 0.009626

‚úÖ Konvergensi tercapai. Iterasi dihentikan.

======== HASIL AKHIR ========
üìå Centroid akhir:
Cluster 1: [6.77334139 3.05189491 5.64469762 2.05273954]
Cluster 2: [5.88754836 2.76057016 4.3619311  1.39627433]
Cluster 3: [5.0039628  3.41415712 1.48270448 0.2534965 ]

üìå Keanggotaan akhir (5 data pertama):
      C1       C2       C3
0.001072 0.002305 0.996624
0.007507 0.016677 0.975816
0.006420 0.013777 0.979802
0.010119 0.022501 0.967379
0.001768 0.003763 0.994469

üìå Fungsi Objektif akhir: 60.505902
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reduksi dimensi data asli ke 2D menggunakan PCA</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Tentukan label cluster berdasarkan nilai keanggotaan maksimum</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Transformasi centroid ke ruang PCA</span>
<span class="n">centroids_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">centroids</span><span class="p">)</span>

<span class="c1"># Plot data dengan warna berdasarkan cluster</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pca</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_pca</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Cluster </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Plot centroid</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centroids_pca</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">centroids_pca</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Centroids&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hasil Akhir Fuzzy C-Means pada Data Iris (PCA 2D)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Principal Component 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Principal Component 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/aa55f688999d4aa5623fbc496deee9e0fbe259a75e79847effbe047e64059c67.png" src="_images/aa55f688999d4aa5623fbc496deee9e0fbe259a75e79847effbe047e64059c67.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#konsep-dasar-fuzzy-c-mean-clustering"><strong>Konsep dasar Fuzzy C-Mean Clustering</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algoritma-fuzzy-c-mean-clustering"><strong>Algoritma Fuzzy C-Mean Clustering</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-langkah-fuzzy-c-mean-clustering"><strong>Langkah-langkah Fuzzy C-Mean Clustering</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-derajat-keanggotaaan"><strong>Update derajat keanggotaaan</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-pusat-cluster"><strong>Update pusat Cluster</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contoh-manual-perhitungan-fuzzy-c-mean-2claster"><strong>Contoh Manual Perhitungan Fuzzy C-Mean (2claster)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#contoh-data-x-1-2">Contoh data <span class="math notranslate nohighlight">\(x_1 = 2\)</span>:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-python-serta-menampilkan-nilai-pusat-cluster-keanggotaan-setiap-iterasi-dan-hitung-fungsi-objektif-setiap-iterasi"><strong>Implementasi Python serta Menampilkan nilai pusat cluster,keanggotaan setiap iterasi dan hitung fungsi objektif setiap iterasi</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-fuzzy-c-means-clustering-untuk-data-iris-3cluster"><strong>Implementasi Fuzzy C-Means Clustering Untuk data Iris (3Cluster)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inisialisasi-data-iris-dan-parameter"><strong>inisialisasi Data Iris dan Parameter</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inisialisasi-derajat-keanggotaan"><strong>Inisialisasi derajat Keanggotaan</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hitung-centroid-berdasarkan-matriks-keanggotaan-u"><strong>Hitung centroid berdasarkan matriks keanggotaan U</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-matriks-keanggotaan-u"><strong>Update matriks keanggotaan U</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hitung-fungsi-objektif-dan-cek-konvergensi"><strong>Hitung Fungsi Objektif dan Cek Konvergensi</strong></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>